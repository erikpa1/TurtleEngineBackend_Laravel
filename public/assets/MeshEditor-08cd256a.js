import{b as s,j as e,R as h,F as c,y as f,P as d,E as v,z as M}from"./index-bbd1ebcb.js";import{A as P,O as C,H as x}from"./OpenAssetFolderButton-b71f53ab.js";import{U as j,a as b,b as m,c as E,S as k}from"./SceneCameraRotationGizmo-f63fe5c1.js";import{u as S}from"./assets_hooks-1bb9fe8a.js";import"./Environment-bbcc9cfa.js";function R({asset:t,onClose:n,onRefresh:o}){const[a]=s.T();return e.jsx(s.Offcanvas,{closeEnabled:!0,onClose:n,header:e.jsx(s.OffcanvasTitle,{children:a("edit")}),children:e.jsx(s.Box,{children:e.jsx(s.Stack,{gap:3})})})}function T(t){s.T();const n=h.useRef(),[o,a]=h.useState(t.defaultMeshPath??c.GetPlatformPath("Meshes/Default.glb"));function r(){d.IsDesktop()?d.OpenSingleMeshDialog(t.expectedExtension).then(l=>{l!==""&&(a(l),t.onMeshSelectDesktop&&t.onMeshSelectDesktop(l))}):n.current.click()}return e.jsx("div",{children:e.jsxs(s.Box,{sx:{borderBottom:1,borderColor:"divider",bgcolor:"background.paper"},style:{padding:"5px"},children:[e.jsxs(j,{preserveDrawingBuffer:!0,style:{height:"250px"},children:[e.jsx(b,{}),e.jsx(m,{}),e.jsx(f,{meshPath:o})]}),e.jsx(s.Button,{label:"select",onClick:r}),e.jsx("input",{ref:n,onChange:r,type:"file",hidden:!0})]})})}function B(t){const[n]=s.T(),[o,a]=v.Cookie.useCookie("mesh-extension","glb"),r=(l,u)=>{a(u)};return e.jsx(s.Offcanvas,{closeEnabled:!0,onClose:t.onClose,header:e.jsx(s.OffcanvasTitle,{children:n("replace")}),children:e.jsx(s.Box,{children:e.jsxs(s.Stack,{gap:3,children:[e.jsx(s.Box,{sx:{borderBottom:1,borderColor:"divider",bgcolor:"background.paper"},children:e.jsxs(s.Tabs,{value:o,variant:"scrollable",scrollButtons:"auto",onChange:r,children:[e.jsx(s.Tab,{label:"Glb",value:"glb"}),e.jsx(s.Tab,{label:"Gltf",value:"gltf"}),e.jsx(s.Tab,{label:"Fbx",value:"fbx"})]})}),e.jsxs(s.Switch,{condition:o,children:[e.jsx(s.Case,{value:"glb",children:e.jsx(D,{...t})}),e.jsx(s.Case,{value:"gltf"}),e.jsx(s.Case,{value:"fbx"})]})]})})})}function D(t){const n=t.asset.data;s.T();const[o,a]=h.useState(c.GetPlatformPath("Meshes/Default.glb"));function r(i){a(i)}function l(i){}function u(){const i=n.uid,p=n._project_uid,g=c.GetPathInProject(p,`Assets/${i}/Default.glb`);M.CopyFile(o,g).then(t.onRefresh)}return e.jsxs(e.Fragment,{children:[e.jsx(T,{expectedExtension:"glb",defaultMeshPath:c.GetPlatformPath("Meshes/Default.glb"),onMeshSelectDesktop:r,onMeshSelectWeb:l}),e.jsx(s.Button,{variant:"outlined",label:"upload",onClick:u})]})}function G(t){const n=s.PopupZus();function o(){n.pushElement(e.jsx(B,{asset:t.asset,onClose:n.popElement,onRefresh:t.onRefresh}))}function a(){n.pushElement(e.jsx(R,{asset:t.asset,onClose:n.popElement,onRefresh:t.onRefresh}))}return e.jsxs(P,{placement:"bottom",children:[e.jsx(C,{asset:t.asset}),e.jsx(x,{lang:"replace",icon:"/icons/Map.svg",onClick:o}),e.jsx(x,{lang:"edit",icon:"/icons/Management.svg",onClick:a})]})}function W({}){const t=S();return t?e.jsx(O,{asset:t}):e.jsx(s.MiddleSpinner,{})}function O({asset:t}){const n=t.data,[o,a]=h.useState(`${n.GetEntryFile()}`);return console.log(o),e.jsxs("div",{style:{position:"relative"},children:[e.jsxs(j,{children:[e.jsx(E,{}),e.jsx(k,{}),e.jsx(b,{}),e.jsx(m,{}),e.jsx(f,{meshPath:o})]}),e.jsx(G,{asset:t,onRefresh:()=>{}})]})}export{W as default};
